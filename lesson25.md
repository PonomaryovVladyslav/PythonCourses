# –õ–µ–∫—Ü–∏—è 25. NoSQL. –ö—É–∫–∏, —Å–µ—Å—Å–∏–∏, –∫–µ—à

![](https://imgb.ifunny.co/images/25d44f01a8e316a90fe39d4d7239a560e7f0c2fe1ae987596cd6788bd8eb1435_1.jpg)
## üìö –í–≤–µ–¥–µ–Ω–∏–µ –≤ NoSQL

`NoSQL` (–æ—Ç –∞–Ω–≥–ª. **Not Only SQL** ‚Äî ¬´–Ω–µ —Ç–æ–ª—å–∫–æ SQL¬ª) ‚Äî —ç—Ç–æ —Ç–µ—Ä–º–∏–Ω, –æ–±–æ–∑–Ω–∞—á–∞—é—â–∏–π —Ç–∏–ø—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, –æ—Ç–ª–∏—á–Ω—ã–µ –æ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –°–£–ë–î. NoSQL –ë–î –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–∏–µ –º–æ–¥–µ–ª–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

–ü–æ–¥—Ä–æ–±–Ω–µ–µ:  
- [–ß—Ç–æ —Ç–∞–∫–æ–µ NoSQL (Azure)](https://azure.microsoft.com/ru-ru/resources/cloud-computing-dictionary/what-is-nosql-database)  
- [–û–±–∑–æ—Ä –Ω–∞ Habr](https://habr.com/ru/articles/152477/)

---

### üß® –ü–æ—á–µ–º—É NoSQL?

NoSQL –ë–î –ø–æ—è–≤–∏–ª–∏—Å—å –∫–∞–∫ –æ—Ç–≤–µ—Ç –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –°–£–ë–î –≤ —É—Å–ª–æ–≤–∏—è—Ö:
- –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è,
- —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä—ë–º–∞–º–∏ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–ª–∞–±–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö,
- –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã—Å–æ–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏.

---

### ‚öñÔ∏è –ü–æ–¥—Ä–æ–±–Ω–æ –æ CAP-—Ç–µ–æ—Ä–µ–º–µ

**CAP-—Ç–µ–æ—Ä–µ–º–∞** (—Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞–µ–º–∞—è **—Ç–µ–æ—Ä–µ–º–æ–π –ë—Ä—é–µ—Ä–∞**) –≥–ª–∞—Å–∏—Ç, —á—Ç–æ **–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å**:

| –°–≤–æ–π—Å—Ç–≤–æ       | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 |
|----------------|--------------------------------------------------------------------------|
| **Consistency** (–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å) | –í—Å–µ —É–∑–ª—ã –≤–∏–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –º–æ–º–µ–Ω—Ç. |
| **Availability** (–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å)    | –°–∏—Å—Ç–µ–º–∞ –≤—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å (–¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è). |
| **Partition Tolerance** (–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é) | –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –¥–∞–∂–µ –µ—Å–ª–∏ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ –µ—Å—Ç—å —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã. |

üß† **–ó–∞—á–µ–º –Ω—É–∂–Ω–∞ CAP-—Ç–µ–æ—Ä–µ–º–∞?**  
–ü—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ NoSQL) —á–∞—Å—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è **–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å —á–µ–º-—Ç–æ** —Ä–∞–¥–∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä:

- –í —Å–ª—É—á–∞–µ —Å–µ—Ç–µ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ **–ª–∏–±–æ –æ—Ç–∫–∞–∑–∞—Ç—å –≤ –¥–æ—Å—Ç—É–ø–µ (–∂–µ—Ä—Ç–≤—É–µ–º A)**,
- –õ–∏–±–æ **–æ—Ç–¥–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ (–∂–µ—Ä—Ç–≤—É–µ–º C)**.

**–í—ã–≤–æ–¥:** —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –º–∞–∫—Å–∏–º—É–º **–¥–≤–∞ –∏–∑ —Ç—Ä—ë—Ö —Å–≤–æ–π—Å—Ç–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**.

**–ü—Ä–∏–º–µ—Ä—ã:**
- üî∏ **Cassandra** ‚Äî AP: –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø–æ–∑–∂–µ (eventual consistency).
- üî∏ **MongoDB (–¥–æ 4.0)** ‚Äî CP: –∂–µ—Ä—Ç–≤—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Å–µ—Ç—å—é.
- üî∏ **Redis (–≤ –∫–ª–∞—Å—Ç–µ—Ä–µ)** ‚Äî —á–∞—â–µ AP.

---

### üî¢ –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã NoSQL –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

![](https://files.codingninjas.in/article_images/types-of-nosql-databases-0-1644120083.webp)

---

#### 1. üóùÔ∏è Key-Value (–ö–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ)

–ü—Ä–æ—Å—Ç–µ–π—à–∞—è –º–æ–¥–µ–ª—å, –Ω–∞–ø–æ–º–∏–Ω–∞—é—â–∞—è —Å–ª–æ–≤–∞—Ä—å: `–∫–ª—é—á ‚Üí –∑–Ω–∞—á–µ–Ω–∏–µ`.

**–ü—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏—è:**

```json
{
  "user:123": "Alice",
  "user:124": "Bob",
  "cart:456": {
    "item": "Book",
    "qty": 2
  }
}
```

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- **Redis –≤ GitHub** ‚Äî –∫–∞–∫ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫—ç—à —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω–æ–≤.
- **DynamoDB –≤ Amazon** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω –∏ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

#### 2. üìÑ Document-oriented (–î–æ–∫—É–º–µ–Ω—Ç–Ω—ã–µ –ë–î)

–•—Ä–∞–Ω—è—Ç –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (JSON, BSON –∏ —Ç.–¥.).

**–ü—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏—è:**

```json
{
  "_id": "user_001",
  "name": "Alice",
  "email": "alice@example.com",
  "orders": [
    {"item": "Book", "qty": 2},
    {"item": "Pen", "qty": 5}
  ]
}
```

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- **MongoDB –≤ eBay** ‚Äî –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç–æ–≤–∞—Ä–æ–≤.
- **CouchDB –≤ BBC** ‚Äî –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ä–µ–∂–∏–º —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π.

---

#### 3. üìä Column-family (–ö–æ–ª–æ–Ω–Ω–æ—á–Ω—ã–µ –ë–î)

–ö–æ–ª–æ–Ω–Ω–æ—á–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö **–Ω–∞ –ø–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥ –ø–æ—Ö–æ–∂–∏ –Ω–∞ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ**, –Ω–æ —Ä–∞–∑–ª–∏—á–∏–µ ‚Äî **–≤ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**.

##### üÜö –í —á—ë–º –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –ë–î?

|                      | –†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –ë–î (PostgreSQL, MySQL) | –ö–æ–ª–æ–Ω–Ω–æ—á–Ω—ã–µ –ë–î (Cassandra, Bigtable)     |
|----------------------|------------------------------------|-------------------------------------------|
| –ï–¥–∏–Ω–∏—Ü–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è     | —Å—Ç—Ä–æ–∫–∞ (row)                       | —Å—Ç–æ–ª–±–µ—Ü (column) –∏–ª–∏ ¬´—Å–µ–º–µ–π—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤¬ª |
| –§–∏–∑–∏—á–µ—Å–∫–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ  | —Å—Ç—Ä–æ–∫–∏ –ª–µ–∂–∞—Ç –≤–º–µ—Å—Ç–µ                | –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –ª–µ–∂–∞—Ç –≤–º–µ—Å—Ç–µ      |
| –°—Ü–µ–Ω–∞—Ä–∏–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –∑–∞–ø–∏—Å—å/—á—Ç–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫                | –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º          |
| –ì–∏–±–∫–æ—Å—Ç—å —Å—Ö–µ–º—ã       | —Å—Ç—Ä–æ–≥–æ –∑–∞–¥–∞–Ω–∞                      | –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –Ω–∞–±–æ—Ä—ã —Å—Ç–æ–ª–±—Ü–æ–≤        |

**–ü—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏—è (—É–ø—Ä–æ—â—ë–Ω–Ω–æ):**

```
RowKey: user1
  Name: Alice
  Age: 30
  City: Prague

RowKey: user2
  Name: Bob
  Age: 25
```

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- **Cassandra –≤ Netflix** ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è.
- **Bigtable –≤ YouTube** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä—ã, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

---

#### 4. üîó Graph (–ì—Ä–∞—Ñ–æ–≤—ã–µ –ë–î)

–ì—Ä–∞—Ñ–æ–≤—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω—è—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ **—É–∑–ª—ã (nodes)** –∏ **—Å–≤—è–∑–∏ (edges)** –º–µ–∂–¥—É –Ω–∏–º–∏.

**–ü—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏—è:**

```
(Alice)-[:FRIEND]->(Bob)
(Alice)-[:LISTENS_TO]->(Song)
(Alice)-[:VISITED]->(Place)
```

##### üß† –ü–æ—á–µ–º—É –≥—Ä–∞—Ñ—ã —Ç–∞–∫ –≤–∞–∂–Ω—ã?

–ú–µ—Ö–∞–Ω–∏–∑–º –ø–æ–∏—Å–∫–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–ø–æ–≤—Å–µ–º–µ—Å—Ç–Ω–æ**:

- **Facebook**: "–í–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∑–Ω–∞–µ—Ç–µ —ç—Ç–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞" ‚Äî —á–µ—Ä–µ–∑ –æ–±—â–∏—Ö –¥—Ä—É–∑–µ–π.
- **Spotify**: "–ü–æ—Ö–æ–∂–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏" ‚Äî —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ—Ö–æ–∂–∏–º–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º–∏.
- **Google Maps**: –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞ ‚Äî –∫–∞–∫ –ø–æ–∏—Å–∫ –∫—Ä–∞—Ç—á–∞–π—à–µ–≥–æ –ø—É—Ç–∏ –≤ –≥—Ä–∞—Ñ–µ –¥–æ—Ä–æ–≥.

–í—Å–µ —ç—Ç–∏ –∑–∞–¥–∞—á–∏ —Ä–µ—à–∞—é—Ç—Å—è **–æ–¥–Ω–∏–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –≥—Ä–∞—Ñ–æ–≤—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏** (DFS, BFS, Dijkstra –∏ —Ç.–¥.) –Ω–∞ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö ‚Äî –≥—Ä–∞—Ñ–∞—Ö.

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- **Neo4j –≤ eBay** ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ antifraud.
- **Amazon Neptune** ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≥—Ä–∞—Ñ—ã –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π.
- **LinkedIn** ‚Äî –ø–æ–∏—Å–∫ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–µ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–≤—è–∑–µ–π.

---

### üí° –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –°—Ü–µ–Ω–∞—Ä–∏–π                      | –¢–∏–ø NoSQL         | –ü—Ä–∏–º–µ—Ä—ã                                      |
|------------------------------|-------------------|----------------------------------------------|
| –ö—ç—à, —Å–µ—Å—Å–∏–∏, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | Key-Value         | Redis, Memcached                             |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, CMS             | Document-oriented | MongoDB, CouchDB                             |
| –ê–Ω–∞–ª–∏—Ç–∏–∫–∞, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã     | Column-family     | Cassandra, Bigtable                          |
| –°–≤—è–∑–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –º–∞—Ä—à—Ä—É—Ç—ã | Graph             | Neo4j, Neptune, OrientDB                     |

---

### üßæ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NoSQL?

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π, –µ—Å–ª–∏:
- —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —á–∞—Å—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è –∏–ª–∏ –Ω–µ—Ñ–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–∞;
- —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å;
- –≤–∞–∂–Ω—ã —Å–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞ –∏ –∑–∞–ø–∏—Å—å –≤ real-time.

‚ùå –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏:
- –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —Å—Ç—Ä–æ–≥–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏;
- –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö JOIN-–æ–ø–µ—Ä–∞—Ü–∏–π;
- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ —Ç–∞–±–ª–∏—á–Ω–∞—è –º–æ–¥–µ–ª—å —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —Å—Ö–µ–º—ã.

---

> üí¨ **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è:**  
> Redis ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. –û–Ω –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –≤ —Å—Ç–µ–∫–µ. –î–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—Ç–µ, –µ–≥–æ —á–∞—Å—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç –ø–æ–∑–∂–µ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—á–µ—Ä–µ–¥–µ–π –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π. –ú—ã —Å –Ω–∏–º –µ—â—ë –ø–æ—Ä–∞–±–æ—Ç–∞–µ–º –¥–∞–ª—å—à–µ –ø–æ –∫—É—Ä—Å—É.
# üç™ –ö—É–∫–∏, üßæ –°–µ—Å—Å–∏–∏ –∏ ‚ö° –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Django

> HTTP-–ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ß—Ç–æ–±—ã "–ø–æ–º–Ω–∏—Ç—å" –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –∏ –Ω–µ –¥–µ–ª–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
> –º–Ω–æ–≥–æ —Ä–∞–∑ ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫—É–∫–∏, —Å–µ—Å—Å–∏–∏ –∏ –∫–µ—à.

---

## üß≠ –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å

- **HTTP stateless** ‚Äî –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å–∞–º –ø–æ —Å–µ–±–µ, –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏.
- **Cookie** ‚Äî —Å–ø–æ—Å–æ–± —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–µ–±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–±—Ä–∞—É–∑–µ—Ä–∞).
- **Session** ‚Äî —Å–ø–æ—Å–æ–± —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É `sessionid`,
  –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–º—É –≤ Cookie.
- **Cache** ‚Äî –±—ã—Å—Ç—Ä–∞—è –ø–∞–º—è—Ç—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º).

---

## üç™ Cookie (–ø–µ—á–µ–Ω—å–∫–∏)

–ö—É–∫–∏ ‚Äî —ç—Ç–æ –ø–∞—Ä—ã `–∫–ª—é—á:–∑–Ω–∞—á–µ–Ω–∏–µ`, –∫–æ—Ç–æ—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä —Ö—Ä–∞–Ω–∏—Ç –ª–æ–∫–∞–ª—å–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –∫–∞–∂–¥—ã–º HTTP-–∑–∞–ø—Ä–æ—Å–æ–º –∫
—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –¥–æ–º–µ–Ω—É.

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**

- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã —Ç–æ–≤–∞—Ä–æ–≤
- –ó–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `sessionid`

![](https://www.web-labs.kz/wp-content/uploads/2020/05/cookie.png)

**–ö—É–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ HTTP –∑–∞–ø—Ä–æ—Å–∞!** –ò—Ö –º–æ–∂–µ—Ç –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –±—Ä–∞—É–∑–µ—Ä, –Ω–æ –ø—Ä—è–º–æ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É –æ–Ω–∏ –Ω–µ
–∏–º–µ—é—Ç!

## üßæ –°–µ—Å—Å–∏–∏

–°–µ—Å—Å–∏—è ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ß–∞—â–µ –≤—Å–µ–≥–æ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
—Å–µ—Å—Å–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∫—É–∫–∏.

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Django:**

```plaintext
–ë—Ä–∞—É–∑–µ—Ä ‚Üí POST /login ‚Üí –°–µ—Ä–≤–µ—Ä:
    - —Å–æ–∑–¥–∞—ë—Ç Session –≤ –ë–î
    - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Set-Cookie: sessionid=<uuid>

–ë—Ä–∞—É–∑–µ—Ä ‚Üí GET /profile ‚Üí Cookie: sessionid ‚Üí –°–µ—Ä–≤–µ—Ä:
    - –¥–æ—Å—Ç–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ request.session
```

![](http://techbriefers.com/wp-content/uploads/2019/10/cookie-and-session-management-process-in-codeigniter.jpg)

**–ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ:**

- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –≤ —Ç–∞–±–ª–∏—Ü–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `django_session`
- –¢–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω—ã:
    - Redis
    - –§–∞–π–ª—ã
    - Signed cookies

---

### üõ† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
# –†–∞–±–æ—Ç–∞ —Å —Å–µ—Å—Å–∏–µ–π –≤ Django
request.session['visited'] = True

# –ü—Ä–æ–≤–µ—Ä–∫–∞
if request.session.get('visited'):
    ...

# –£–¥–∞–ª–µ–Ω–∏–µ
del request.session['visited']
```

### üí° –ü—Ä–∏–º–µ—Ä ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

```python
def post_comment(request, comment):
    if request.session.get('has_commented', False):
        return HttpResponse("You've already commented.")
    request.session['has_commented'] = True
    return HttpResponse("Thanks!")
```

### üß™ –ü—Ä–∏–º–µ—Ä ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏

```python
request.session['last_action'] = timezone.now()
```

---

### üß© –í–Ω–µ –∑–∞–ø—Ä–æ—Å–∞ (SessionStore)

```python
from django.contrib.sessions.backends.db import SessionStore

s = SessionStore()
s['foo'] = 'bar'
s.create()
s.session_key  # —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –∫–ª—é—á
```

---

### üõë –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã

- –ö–ª—é—á–∏ —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫–∏ (JSON)
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏** `request.session` –∫–∞–∫ –æ–±—ä–µ–∫—Ç–∞

```python
request.session['foo'] = 'bar'  # —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è
request.session['foo']['x'] = 1  # ‚ùå –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è
```

‚úÖ –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

```python
SESSION_SAVE_EVERY_REQUEST = True
```

---

### üßπ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–µ—Å—Å–∏–π

```bash
python manage.py clearsessions
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```python
from django.contrib.sessions.models import Session

Session.objects.filter(...).delete()
```

---

## ‚ö° –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–µ—à ‚Äî —ç—Ç–æ **–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º –¥–∞–Ω–Ω—ã–º.

![](https://cdn.acunetix.com/wp_content/uploads/2018/12/image1-1.png)

### üí° –ü—Ä–∏–º–µ—Ä

```python
# –í–º–µ—Å—Ç–æ:
Article.objects.filter(published=True).order_by('-date')[:5]

# –õ—É—á—à–µ:
articles = cache.get('homepage_articles')
if not articles:
    articles = Article.objects.filter(...).all()
    cache.set('homepage_articles', articles, timeout=3600)
```

---

## üì¶ –í–∞—Ä–∏–∞–Ω—Ç—ã backends

| –•—Ä–∞–Ω–∏–ª–∏—â–µ  | –ü–ª—é—Å—ã                                     | –ú–∏–Ω—É—Å—ã                       |
|------------|-------------------------------------------|------------------------------|
| Redis      | –ë—ã—Å—Ç—Ä–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–∞–º—è—Ç–∏, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è | –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —Å–µ—Ä–≤–µ—Ä–∞  |
| Memcached  | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π, –ø—Ä–æ—Å—Ç–æ–π                    | –¢–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∫–ª—é—á–∏       |
| FileBased  | –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä–≤–µ—Ä–æ–≤                       | –ú–µ–¥–ª–µ–Ω–Ω—ã–π –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö |
| Database   | –ù–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å               | –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î               |
| DummyCache | –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç (–¥–ª—è dev)                | –ù–µ—Ç –∫–µ—à–∞ :)                  |

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–µ—à–∞ (–ø—Ä–∏–º–µ—Ä Redis)

```python
CACHES = {
    "default": {
        "BACKEND": "django_redis.cache.RedisCache",
        "LOCATION": "redis://127.0.0.1:6379/1",
        "OPTIONS": {
            "CLIENT_CLASS": "django_redis.client.DefaultClient"
        }
    }
}
```

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from django.core.cache import cache

cache.set("key", "value", timeout=60)
cache.get("key")  # "value"
cache.delete("key")
```

–ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

```python
cache.set_many({"a": 1, "b": 2})
cache.get_many(["a", "b"])
```

---

## üß± –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ view

```python
from django.views.decorators.cache import cache_page


@cache_page(60 * 15)
def my_view(request):
    ...
```

–ò–ª–∏ –≤ `urls.py`:

```python
path("foo/", cache_page(900)(views.foo_view))
```

---

## üß∞ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤

```django
{% load cache %}
{% cache 300 sidebar %}
    ...HTML sidebar...
{% endcache %}
```

---

## üßº –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞

```python
cache.clear()
```

---

## ‚õî –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–µ—à–∞ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–π view

```python
from django.views.decorators.cache import never_cache


@never_cache
def dynamic_view(request):
    ...
```

---

## üìå –ò—Ç–æ–≥–∏

- –ö—É–∫–∏ ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (–±—Ä–∞—É–∑–µ—Ä–µ).
- –°–µ—Å—Å–∏–∏ ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
- –ö–µ—à ‚Äî –±—ã—Å—Ç—Ä–∞—è –ø–∞–º—è—Ç—å –¥–ª—è **—É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã**, –Ω–µ —Å–≤—è–∑–∞–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
- –í—Å—ë —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è **–±–µ–∑–æ–ø–∞—Å–Ω–æ–π**, **–±—ã—Å—Ç—Ä–æ–π** –∏ **—É–¥–æ–±–Ω–æ–π** —Ä–∞–±–æ—Ç—ã —Å–∞–π—Ç–∞.

---

## üß† –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è

1. –ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –∫—É–∫–∏ –æ—Ç —Å–µ—Å—Å–∏–π?
2. –ü–æ—á–µ–º—É —Å–µ—Å—Å–∏–∏ –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–µ–∑–¥–µ?
3. –ì–¥–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Django —Ö—Ä–∞–Ω–∏—Ç —Å–µ—Å—Å–∏–∏?
4. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –µ—Å–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `request.session['key']['value']`?
5. –ö–∞–∫ –±—ã –≤—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã?
6. –ö–∞–∫ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Å—Å–∏–∏, —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π?

---
